<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../chrome-devreloader/chrome-devreloader.html">
<link rel="import" href="../github-oauth/github-oauth.html">
<link rel="import" href="../gravatar-detector/gravatar-detector.html">
<link rel="import" href="../event-bus/chrome-event-relay.html">
<link rel="import" href="../event-bus/chrome-event-source.html">
<link rel="import" href="../event-bus/chrome-tab-event-relay.html">
<link rel="import" href="../event-bus/websocket-event-sink.html">
<link rel="stylesheet" type="text/css" href="workrooms-application.css">

<polymer-element name="workrooms-application" attributes="config calls userprofiles serverconfig">
<template>
  <!--send along events to the extension from the websocket-->
  <chrome-event-relay id="conference" to="conference" events="configured calls userprofiles ice offer answer autocomplete">
  <chrome-event-relay id="screenshare" to="screenshare" events="configured ice offer answer">
  <!--send along events to all tabs coming from the websocket, used in content scripts-->
  <chrome-tab-event-relay sendevents="online" listenevents="">
  <websocket-event-sink id="server" events="userprofile register call sharescreen ice offer answer hangup autocomplete isonline" server="{{config.signallingServer}}">
  <chrome-tab-event-relay id="gravatars" sendevents="" listenevents="isonline call">
  </chrome-event-source>
  <!--this will get chrome messages that need a chance at the socket-->
  <chrome-event-source id="background" name="background">
  <chrome-devreloader config="{{ config }}"></chrome-devreloader>
  <github-oauth id="github" clientid="{{ serverconfig.github.clientid }}" clientsecret="{{ serverconfig.github.clientsecret }}"></github-oauth>
  <gravatar-detector></gravatar-detector>
  </chrome-event-source>
  </websocket-event-sink>
  </chrome-tab-event-relay>
  </chrome-event-relay>
  </chrome-event-relay>
</template>
<script src="./workrooms-application.js"></script>
</polymer-element>
